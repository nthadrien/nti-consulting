---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

import LanguageSwitcher from "./LanguageSwitcher.astro";
import Logo from "./Logo.astro";
import ThemeSwitcher from "./ThemeSwitcher.astro";
---

<nav class="nav-scrolled">
    <Logo />

    <div class="side-menu">
        <a href={`/nti-consulting/${lang}/`}>
            {t('nav.home')}
          </a>
          <a href={`/nti-consulting/${lang}/services`}>
            {t('nav.services')}
          </a>
          <a href={`/nti-consulting/${lang}/about`}>
            {t('nav.about')}
          </a>
        <ThemeSwitcher />
        <LanguageSwitcher />
        <a class="cbtn" href="#contacts">contactez nous</a>
    </div>

    <label>
        <input type="checkbox" name="nav-toggle" />
    </label>
</nav>

<style>
    nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
        width: 100%;
        height: fit-content;
        margin: 0 auto;
        padding: 0.5rem 1rem;
        position: fixed;
        top: 0;
        color: white;
        /* box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px; */
        z-index: 3;
    }

    input {
        display: inline;
        border: none;
        outline: none;
        appearance: none;
        -webkit-appearance: none;
        background: var(--sc-clr, rgb(69, 62, 62));
    }
    :checked {
        background: red;
    }

    .side-menu {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 1rem;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 3;
        height: 100vh;
        width: 100%;
        background: var(--nt-clr);
        color: #333;
        transform: translateY(-100vh);
        transition: all 0.4s ease-out;
    }

    label {
        justify-self: end;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: center;
        height: 40px;
        width: 40px;
        z-index: 4;
    }

    label::after,
    label::before,
    input {
        content: ".";
        width: 32px;
        height: 4px;
        background: var(--cm-clr, rgb(81, 67, 67));
        border-radius: 5px;
        margin: 0 auto;
    }

    nav:has(input:checked) .side-menu {
        transform: translateY(0vh);
    }

    label:has(input:checked)::after {
        rotate: -45deg;
    }

    label:has(input:checked)::before {
        rotate: -45deg;
        background: rebeccapurple;
    }

    .nav-scrolled {
        box-shadow: rgba(0, 0, 0, 0.15) 0px 3px 3px 0px;
        background: var(--nt-clr);
        color: #333;
    }

    .side-menu {
        background: var(--nt-clr);
        color: #333;
    }

    :global(.dark) .nav-scrolled,
    :global(.dark) .side-menu {
        background: #333;
        color: white;
    }

    .cbtn {
        background: inherit;
        color: inherit;
    }

    @media (min-width: 640px) {
        label {
            display: none;
        }

        :global(.dark) .side-menu, .side-menu {
            flex-direction: row;
            transform: translateY(0vh);
            position: static;
            height: fit-content;
            width: fit-content;
            background-color: inherit;
            color: inherit;
        }

        .cbtn {
            background: var(--pr-clr);
            color: white;
            padding: 0.5rem;
        }

        .cbtn:hover {
            background: var(--cm-clr);
            color: white;
        }
    }
</style>
